## 13장. 무결성과 보안
----------------------
˚‧º·(˚ ˃̣̣̥⌓˂̣̣̥ )‧º·˚


### 무결성

- 데이타 베이스의 무결성이란 <b>데이터의 정밀성, 정확성</b>을 의미
- 사용자가 데이터를 사용할때 무결성(깨끗)을 헤지치 않아야함
- 데이터베이스의 초기 상태 이후에 일어나는 <b>갱신</b>으로 인해, 발생하는 상황에 대한 보호에 초점이 맞춰짐
    - 여기서의 갱신은 인증된(허가받은) 사용자에 의한 갱신을 뜻하며
    - 보호의 내용은 의미적인 오류(semantic error)대한 보호이다


#### 무결성 서브 시스템(integrity subsystem)

- 데이타베이스 시스템은 무결성을 유지하기 위해 <b>DBMS의 한 구성요소</b>를 가지고있음
    - 무결성 규정을 관리,유지, 트랜잭션이 수행하는 갱신 연산이 무결성 규정에 위반되지 않는지를 검사
    - 뮤결성 규정은 <b>규정 이름, 검사 시기, 제약 조건, 위반 조치</b> 등을 포함
        - 규정 이름 : 규정을 참조할 떄 사용하는 식별자(identifier)
        - 검사 시기 : 트랜잭션의 접근 유형 과 데이터와 함께 검사해야 될 시기를 명세
        - 제약 조건 : 데이터가 만족해야 될 제약 조건
        - 위반 조치 : 위반이 발생했을 경우 취해야할 대응 조치 명세
        
------------   
사용자쿼리 -> [보안 서브 시스템] 

-> 갱신연산 -> [무결성 서브 시스템] 

-> 갱신수행 -> [정확한 데이터베이스]

----------

#### 무결성 규정 요건

1. 고급 언어 사용
    - 데이터 제어를 책임지는 DBA가 DCL(제어어)를 이용하여 명시적으로 기술, SQL같은 고급 언어 사용
2. 카탈로그 또는 사전에 저장(질의 할수 있음)
    - 무결성 제어 서브 시스템에 의해 저장됨
3. 시스템에 의해 바로 실행
    - 시스템에 들어가면 이 규정들은 그 시점부터 바로 시행됨

#### 무결성 규정의 대상과 종류

도메인, 키, 종속성, 관계성 등 여러가지가 존재

##### 무결성 규정의 종류

- 도메인 무결성 규정
    - 주어진 attr의 값이 그 attr가 정의된 도메인에 속한 값이어야함 (삽입이나 갱신 연산시 적용)
- 릴레이션 무결성 규정
    - 어느 한 튜플이 릴레이션에 삽입 될 수 있는가?
    - 어느 한 릴레이션이 또 다른 릴레이션의 튜플과의 관계가 적절한가?
        - 를 규정짓는 것(의미적인 관계에 관한 것, 삽입-삭제-갱신 과 같은 연산의 수행 전후에 관한..)

#### 릴레이션 무결성 규정의 다양한 유형

1. 상태 제약 - DB의 일관성있는 상태 조건 명세, DB 상태 : 어느 특정 시점에 DB내 저장되 있는 값을 말함
    - 각 DB 상태가 모두 만족해야 하는 규정, 정적 제약의 성질을 가짐
2. 과도 제약 - 다른상태로 변환되는 과정 조건 명세, 상태의 변환 직전과 직후의 비교가 관련됨
    - 동적 제약

3. 집합 제약 - 특정 투플 집합 <b>전체</b>에 관한 규정
4. 투플 제약 - <b>처리되고 있는 투플</b>에 적용 규정
5. 즉시 제약 - 삽입-삭제-갱신 연산이 수행된 즉시 적용되는 규정(제약)
6. 지연 제약 - 트랜잭션이 완전히 수행된 뒤 적용되는 규정
    - 디스크에서 가져온 값이 모두 변경되면 디스크에 저장(로그를 둠)

#### 트리거란?
- 무결성을 유지하는 프로그램
- 트리거 조건이 만족되는 경우, 취해야 되는 조치를 명세

----------------


### 데이터베이스 보안 

- 불법적인 폭로, 변경, 파괴로부터 데이터 보호

#### 직접 접근 제어

- 가장 쉬운 방법은 암호 사용
- 일반적인 방법은 권한 테이블 사용
    - 허가된 사용자, 허가 데이타, 허용 연산, 허가 조건 포함
    - GRANT..
    - 권한 부여 테이블 : 시스템은 모든 사용자에 대한 권한 테이블을 하나의 테이블로 종합해서 관리

#### 간접 접근 제어

- 임의 접근 제어 방식
- 암호화 기법은 데이타를 뒤섞은 뒤, 다른 사람이 그대로 사용할수 없도록 하는것
    - 데이터 암호화
        - 허가 받지 않은 사람이 데이터나 메세지의 내용을 알수 없도록 은폐 시키기 위해 데이터를 암호로 바꾸는것

#### 보안 집행기

- 데이터베이스를 마음대로 접근할수 있기 때문에 

    접근 요청이 오면 권한 테이블을 검사해 접근을 허가할 것인지 거부할 것인지 결정

#### 뷰 기법

- 테이블에 직접 접근하지 못하고 view를 통해 접근

- 보안에 민감한 데이터를 권한이 없는 사용자로부터 은닉시킬수 있음, 불법적인 접근 예방 가능

- 단점 : 갱신, 삽입, 삭제 연산에 제약을 가질 수 있음

#### 테이블 생성자?

- 테이블에 대한 모든 권한 가짐

- 권한 일부를 다른 사용자에게 부여 가능

- 테이블 제거 권한은 부여 불가

 

#### GRANT/REVOKE 기법

- <b>SQL에서 권한부여</b>는 GRANT명령문에 의해 명세됨

```DBA : GRANT INSERT, DELETE ON STUDENT TO U1;```

- DBA가 사용자 U1에게 STUDENT 릴레이션에 대한 삽입과 삭제 권한을 부여

```DBA : GRANT SELECT ON STUDENT TO U2 WITH GRANT OPTION;```

- DBA가 사용자 U2에게 STUDENT 릴레이션 검색 기능 부여, GRANT OPTION은 <b>다른 사용자에게 권한 부여할 수 있게끔</b> 권한 부여

```U2 : GRANT SELECT ON STUDENT TO U3;```
- U2가 사용자 U3에게 STUDENT 릴레이션 검색 기능 부여

```DBA :  REVOKE SELECT ON STUDENT FROM U2 CASCADE;```
- U2에게 검색 기능을 회수 시킴, CASCADE는 U2가 U3에게 부여한 권한(연관되어진 모든..)까지 취소 시킴
- 만약 GRANT OPTION FOR가 사용되면 접근 권한을 취소하는 것이 아니라 다른 사용자에게 권한을 부여할수 있게 한 권한 자체를 취소함